<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv='Content-Type' content='text/html; charset=utf-8'></meta>
    <link rel='stylesheet' type='text/css' href='statprofiler.css'></link>
    <title>StatProfilerHTML - ../src/analysis/critical_points.jl</title>
  </head>
  <body>
    <div class='report-header'>
      <div class='backlink'>
        <a href='index.html'>Report index</a>
      </div>
      <div class='report-title'>
        StatProfilerHTML.jl report
      </div>
      <div class='generated-on'>
        Generated on Tue, 16 Apr 2024 17:21:59
      </div>
    </div>
    <table>
      <caption>File source code</caption>
      <thead>
        <tr>
          <th>Line</th>
          <th>Exclusive</th>
          <th>Inclusive</th>
          <th>Code</th>
        </tr>
      </thead>
      <tbody>
        <tr id='L1'>
          <td class='lineno'>1</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>using NLsolve: nlsolve</span>
          </td>
        </tr>
        <tr id='L2'>
          <td class='lineno'>2</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>using LinearAlgebra: eigvals, det, normalize</span>
          </td>
        </tr>
        <tr id='L3'>
          <td class='lineno'>3</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L4'>
          <td class='lineno'>4</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>export CriticalPointType, CriticalPoint, find_cps, poincare_hopf_value</span>
          </td>
        </tr>
        <tr id='L5'>
          <td class='lineno'>5</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L6'>
          <td class='lineno'>6</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>&quot;&quot;&quot;</span>
          </td>
        </tr>
        <tr id='L7'>
          <td class='lineno'>7</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>@enum CriticalPointType</span>
          </td>
        </tr>
        <tr id='L8'>
          <td class='lineno'>8</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L9'>
          <td class='lineno'>9</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>Enumeration representing different types of 2d and 3d critical points.</span>
          </td>
        </tr>
        <tr id='L10'>
          <td class='lineno'>10</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>3d points are named after their QTAIM counterparts, and 2d points have</span>
          </td>
        </tr>
        <tr id='L11'>
          <td class='lineno'>11</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>a &quot;2&quot; suffix.</span>
          </td>
        </tr>
        <tr id='L12'>
          <td class='lineno'>12</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L13'>
          <td class='lineno'>13</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>## Example Usage</span>
          </td>
        </tr>
        <tr id='L14'>
          <td class='lineno'>14</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>&#96;&#96;&#96;julia</span>
          </td>
        </tr>
        <tr id='L15'>
          <td class='lineno'>15</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>cp_type &#61; CriticalPointType.nuclear_cp</span>
          </td>
        </tr>
        <tr id='L16'>
          <td class='lineno'>16</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>&#96;&#96;&#96;</span>
          </td>
        </tr>
        <tr id='L17'>
          <td class='lineno'>17</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>&quot;&quot;&quot;</span>
          </td>
        </tr>
        <tr id='L18'>
          <td class='lineno'>18</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>@enum CriticalPointType begin</span>
          </td>
        </tr>
        <tr id='L19'>
          <td class='lineno'>19</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    nuclear_cp &#61; -3</span>
          </td>
        </tr>
        <tr id='L20'>
          <td class='lineno'>20</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    maximum2_cp &#61; -2</span>
          </td>
        </tr>
        <tr id='L21'>
          <td class='lineno'>21</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    bond_cp &#61; -1</span>
          </td>
        </tr>
        <tr id='L22'>
          <td class='lineno'>22</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    saddle2_cp &#61; 0</span>
          </td>
        </tr>
        <tr id='L23'>
          <td class='lineno'>23</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    ring_cp &#61; 1</span>
          </td>
        </tr>
        <tr id='L24'>
          <td class='lineno'>24</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    minimum2_cp &#61; 2</span>
          </td>
        </tr>
        <tr id='L25'>
          <td class='lineno'>25</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    cage_cp &#61; 3</span>
          </td>
        </tr>
        <tr id='L26'>
          <td class='lineno'>26</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>end</span>
          </td>
        </tr>
        <tr id='L27'>
          <td class='lineno'>27</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L28'>
          <td class='lineno'>28</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>&quot;&quot;&quot;</span>
          </td>
        </tr>
        <tr id='L29'>
          <td class='lineno'>29</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    IsValidCriticalPointType&#40;ind::Integer&#41;</span>
          </td>
        </tr>
        <tr id='L30'>
          <td class='lineno'>30</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L31'>
          <td class='lineno'>31</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>Check if an input integer is a valid value for the &#96;CriticalPointType&#96; enum.</span>
          </td>
        </tr>
        <tr id='L32'>
          <td class='lineno'>32</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L33'>
          <td class='lineno'>33</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'># Arguments</span>
          </td>
        </tr>
        <tr id='L34'>
          <td class='lineno'>34</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>- &#96;ind::Integer&#96;: The input value to check if it is a valid &#96;CriticalPointType&#96; enum value.</span>
          </td>
        </tr>
        <tr id='L35'>
          <td class='lineno'>35</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L36'>
          <td class='lineno'>36</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'># Returns</span>
          </td>
        </tr>
        <tr id='L37'>
          <td class='lineno'>37</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>- &#96;result::Bool&#96;: &#96;true&#96; if the input &#96;ind&#96; is a valid &#96;CriticalPointType&#96; value, &#96;false&#96; otherwise.</span>
          </td>
        </tr>
        <tr id='L38'>
          <td class='lineno'>38</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L39'>
          <td class='lineno'>39</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'># Example</span>
          </td>
        </tr>
        <tr id='L40'>
          <td class='lineno'>40</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>&#96;&#96;&#96;julia</span>
          </td>
        </tr>
        <tr id='L41'>
          <td class='lineno'>41</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>ind &#61; 1</span>
          </td>
        </tr>
        <tr id='L42'>
          <td class='lineno'>42</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>result &#61; IsValidCriticalPointType&#40;ind&#41;</span>
          </td>
        </tr>
        <tr id='L43'>
          <td class='lineno'>43</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>println&#40;result&#41;  # true</span>
          </td>
        </tr>
        <tr id='L44'>
          <td class='lineno'>44</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>&#96;&#96;&#96;</span>
          </td>
        </tr>
        <tr id='L45'>
          <td class='lineno'>45</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>&quot;&quot;&quot;</span>
          </td>
        </tr>
        <tr id='L46'>
          <td class='lineno'>46</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>function IsValidCriticalPointType&#40;ind::Integer&#41;</span>
          </td>
        </tr>
        <tr id='L47'>
          <td class='lineno'>47</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    return ind in Int.&#40;instances&#40;CriticalPointType&#41;&#41;</span>
          </td>
        </tr>
        <tr id='L48'>
          <td class='lineno'>48</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>end</span>
          </td>
        </tr>
        <tr id='L49'>
          <td class='lineno'>49</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L50'>
          <td class='lineno'>50</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>&quot;&quot;&quot;</span>
          </td>
        </tr>
        <tr id='L51'>
          <td class='lineno'>51</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    struct CriticalPoint</span>
          </td>
        </tr>
        <tr id='L52'>
          <td class='lineno'>52</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L53'>
          <td class='lineno'>53</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>The &#96;CriticalPoint&#96; struct represents a critical point in Julia.</span>
          </td>
        </tr>
        <tr id='L54'>
          <td class='lineno'>54</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L55'>
          <td class='lineno'>55</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'># Fields</span>
          </td>
        </tr>
        <tr id='L56'>
          <td class='lineno'>56</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>- &#96;r::Vector&#123;T&#125;&#96;: A vector with the cp position. The length of the vector determines the cp_index.</span>
          </td>
        </tr>
        <tr id='L57'>
          <td class='lineno'>57</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>- &#96;type::Int&#96;: An integer representing the type.</span>
          </td>
        </tr>
        <tr id='L58'>
          <td class='lineno'>58</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>- &#96;i_atom::Int&#96;: An integer representing the atom index.</span>
          </td>
        </tr>
        <tr id='L59'>
          <td class='lineno'>59</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L60'>
          <td class='lineno'>60</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>## Example Usage</span>
          </td>
        </tr>
        <tr id='L61'>
          <td class='lineno'>61</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>&#96;&#96;&#96;julia</span>
          </td>
        </tr>
        <tr id='L62'>
          <td class='lineno'>62</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>cp &#61; CriticalPoint&#40;&#91;1.0, 2.0, 3.0&#93;, 1, 2&#41;</span>
          </td>
        </tr>
        <tr id='L63'>
          <td class='lineno'>63</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>&#96;&#96;&#96;</span>
          </td>
        </tr>
        <tr id='L64'>
          <td class='lineno'>64</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>&quot;&quot;&quot;</span>
          </td>
        </tr>
        <tr id='L65'>
          <td class='lineno'>65</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>struct CriticalPoint&#123;T&lt;:AbstractFloat&#125;</span>
          </td>
        </tr>
        <tr id='L66'>
          <td class='lineno'>66</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    r::Vector&#123;T&#125; # length of r determines cp_index</span>
          </td>
        </tr>
        <tr id='L67'>
          <td class='lineno'>67</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    type::CriticalPointType</span>
          </td>
        </tr>
        <tr id='L68'>
          <td class='lineno'>68</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    i_atom::Int</span>
          </td>
        </tr>
        <tr id='L69'>
          <td class='lineno'>69</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>end</span>
          </td>
        </tr>
        <tr id='L70'>
          <td class='lineno'>70</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L71'>
          <td class='lineno'>71</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>&quot;&quot;&quot;</span>
          </td>
        </tr>
        <tr id='L72'>
          <td class='lineno'>72</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    CriticalPoint&#40;r::Vector&#123;T&#125;, type::Integer, i_atom::Integer&#41;</span>
          </td>
        </tr>
        <tr id='L73'>
          <td class='lineno'>73</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L74'>
          <td class='lineno'>74</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>Create a new instance of the &#96;CriticalPoint&#96; type.</span>
          </td>
        </tr>
        <tr id='L75'>
          <td class='lineno'>75</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>&#96;type&#96; integers are the following:</span>
          </td>
        </tr>
        <tr id='L76'>
          <td class='lineno'>76</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>* nuclear_cp &#61; -3</span>
          </td>
        </tr>
        <tr id='L77'>
          <td class='lineno'>77</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>* maximum2_cp &#61; -2</span>
          </td>
        </tr>
        <tr id='L78'>
          <td class='lineno'>78</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>* bond_cp &#61; -1</span>
          </td>
        </tr>
        <tr id='L79'>
          <td class='lineno'>79</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>* saddle2_cp &#61; 0</span>
          </td>
        </tr>
        <tr id='L80'>
          <td class='lineno'>80</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>* ring_cp &#61; 1</span>
          </td>
        </tr>
        <tr id='L81'>
          <td class='lineno'>81</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>* minimum2_cp &#61; 2</span>
          </td>
        </tr>
        <tr id='L82'>
          <td class='lineno'>82</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>* cage_cp &#61; 3</span>
          </td>
        </tr>
        <tr id='L83'>
          <td class='lineno'>83</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L84'>
          <td class='lineno'>84</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>## Arguments</span>
          </td>
        </tr>
        <tr id='L85'>
          <td class='lineno'>85</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>- &#96;r&#96;: A vector representing the coordinates of a point.</span>
          </td>
        </tr>
        <tr id='L86'>
          <td class='lineno'>86</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>- &#96;type&#96;: An integer representing the type of critical point. </span>
          </td>
        </tr>
        <tr id='L87'>
          <td class='lineno'>87</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>- &#96;i_atom&#96;: An integer representing the index of the atom.</span>
          </td>
        </tr>
        <tr id='L88'>
          <td class='lineno'>88</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L89'>
          <td class='lineno'>89</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>## Returns</span>
          </td>
        </tr>
        <tr id='L90'>
          <td class='lineno'>90</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>- An instance of the &#96;CriticalPoint&#96; type, representing a critical point with the given coordinates, type, and atom index.</span>
          </td>
        </tr>
        <tr id='L91'>
          <td class='lineno'>91</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L92'>
          <td class='lineno'>92</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>## Example</span>
          </td>
        </tr>
        <tr id='L93'>
          <td class='lineno'>93</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>&#96;&#96;&#96;julia</span>
          </td>
        </tr>
        <tr id='L94'>
          <td class='lineno'>94</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>r &#61; &#91;1.0, 2.0, 3.0&#93;</span>
          </td>
        </tr>
        <tr id='L95'>
          <td class='lineno'>95</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>type &#61; 1</span>
          </td>
        </tr>
        <tr id='L96'>
          <td class='lineno'>96</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>i_atom &#61; 2</span>
          </td>
        </tr>
        <tr id='L97'>
          <td class='lineno'>97</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>cp &#61; CriticalPoint&#40;r, type, i_atom&#41;</span>
          </td>
        </tr>
        <tr id='L98'>
          <td class='lineno'>98</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>&#96;&#96;&#96;</span>
          </td>
        </tr>
        <tr id='L99'>
          <td class='lineno'>99</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>&quot;&quot;&quot;</span>
          </td>
        </tr>
        <tr id='L100'>
          <td class='lineno'>100</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>function CriticalPoint&#40;</span>
          </td>
        </tr>
        <tr id='L101'>
          <td class='lineno'>101</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    r::Vector&#123;T&#125;, type::Integer; i_atom::Integer&#61;0</span>
          </td>
        </tr>
        <tr id='L102'>
          <td class='lineno'>102</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>&#41; where &#123;T&lt;:AbstractFloat&#125;</span>
          </td>
        </tr>
        <tr id='L103'>
          <td class='lineno'>103</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    @assert IsValidCriticalPointType&#40;type&#41;</span>
          </td>
        </tr>
        <tr id='L104'>
          <td class='lineno'>104</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    return CriticalPoint&#40;r, CriticalPointType&#40;type&#41;, i_atom&#41;</span>
          </td>
        </tr>
        <tr id='L105'>
          <td class='lineno'>105</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>end</span>
          </td>
        </tr>
        <tr id='L106'>
          <td class='lineno'>106</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L107'>
          <td class='lineno'>107</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>&quot;&quot;&quot;</span>
          </td>
        </tr>
        <tr id='L108'>
          <td class='lineno'>108</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    poincare_hopf_value&#40;cps::Vector&#123;CriticalPoint&#125;&#41;::Int</span>
          </td>
        </tr>
        <tr id='L109'>
          <td class='lineno'>109</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L110'>
          <td class='lineno'>110</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>Check if the Poincaré-Hopf relation is satisfied for a given set of critical points.</span>
          </td>
        </tr>
        <tr id='L111'>
          <td class='lineno'>111</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L112'>
          <td class='lineno'>112</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>The Poincaré-Hopf theorem relates the sum of the indices of all critical points of a vector field to the Euler characteristic of the underlying manifold. Specifically, the theorem states that the sum of the indices of all critical points is equal to the Euler characteristic of the manifold.</span>
          </td>
        </tr>
        <tr id='L113'>
          <td class='lineno'>113</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L114'>
          <td class='lineno'>114</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>This function takes a vector of critical points &#96;cps&#96; and checks if the sum of the indices of all critical points in &#96;cps&#96; is equal to the Euler characteristic of the underlying manifold. If the sum of the indices is equal to the Euler characteristic, the function returns &#96;true&#96;. Otherwise, it returns &#96;false&#96;.</span>
          </td>
        </tr>
        <tr id='L115'>
          <td class='lineno'>115</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L116'>
          <td class='lineno'>116</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'># Arguments</span>
          </td>
        </tr>
        <tr id='L117'>
          <td class='lineno'>117</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>- &#96;cps::Vector&#123;CriticalPoint&#125;&#96;: A vector of critical points.</span>
          </td>
        </tr>
        <tr id='L118'>
          <td class='lineno'>118</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L119'>
          <td class='lineno'>119</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'># Returns</span>
          </td>
        </tr>
        <tr id='L120'>
          <td class='lineno'>120</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>- &#96;result::Int&#96;: &#96;1&#96; if the sum of the indices of all critical points in &#96;cps&#96; is equal to the Euler characteristic of the underlying manifold, &#96;0&#96; otherwise.</span>
          </td>
        </tr>
        <tr id='L121'>
          <td class='lineno'>121</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L122'>
          <td class='lineno'>122</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'># Examples</span>
          </td>
        </tr>
        <tr id='L123'>
          <td class='lineno'>123</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>&#96;&#96;&#96;julia</span>
          </td>
        </tr>
        <tr id='L124'>
          <td class='lineno'>124</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>cps &#61; &#91;CriticalPoint&#40;&#91;1.0, 2.0, 3.0&#93;, -3&#41;, CriticalPoint&#40;&#91;1.0, 2.0, -3.0&#93;, -3&#41;, CriticalPoint&#40;&#91;1.0, 2.0, 0.0&#93;, -1&#41;&#93;</span>
          </td>
        </tr>
        <tr id='L125'>
          <td class='lineno'>125</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>result &#61; poincare_hopf_value&#40;cps&#41;</span>
          </td>
        </tr>
        <tr id='L126'>
          <td class='lineno'>126</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>println&#40;result&#41;  # true</span>
          </td>
        </tr>
        <tr id='L127'>
          <td class='lineno'>127</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>&#96;&#96;&#96;</span>
          </td>
        </tr>
        <tr id='L128'>
          <td class='lineno'>128</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>&quot;&quot;&quot;</span>
          </td>
        </tr>
        <tr id='L129'>
          <td class='lineno'>129</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>function poincare_hopf_value&#40;cps::Vector&#123;CriticalPoint&#125;&#41;::Int</span>
          </td>
        </tr>
        <tr id='L130'>
          <td class='lineno'>130</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    cp_types &#61; &#91;nuclear_cp, bond_cp, ring_cp, cage_cp&#93;</span>
          </td>
        </tr>
        <tr id='L131'>
          <td class='lineno'>131</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    cp_counts &#61; &#91;length&#40;filter&#40;x -&gt; x.type &#61;&#61; t, cps&#41;&#41; for t in cp_types&#93;</span>
          </td>
        </tr>
        <tr id='L132'>
          <td class='lineno'>132</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    ph_rel &#61; cp_counts&#91;1&#93; - cp_counts&#91;2&#93; &#43; cp_counts&#91;3&#93; - cp_counts&#91;4&#93;</span>
          </td>
        </tr>
        <tr id='L133'>
          <td class='lineno'>133</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    return ph_rel</span>
          </td>
        </tr>
        <tr id='L134'>
          <td class='lineno'>134</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>end</span>
          </td>
        </tr>
        <tr id='L135'>
          <td class='lineno'>135</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L136'>
          <td class='lineno'>136</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>&quot;&quot;&quot;</span>
          </td>
        </tr>
        <tr id='L137'>
          <td class='lineno'>137</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    cp_should_be_skipped&#40;check_cp::CriticalPoint, cp_info::Vector&#123;CriticalPoint&#125;; cutoff_dist_min&#61;0.0, cutoff_dist_max&#61;6.0, cutoff_dist_min_nuc_nuc&#61;1.0, cutoff_index&#61;4&#41; -&gt; Bool</span>
          </td>
        </tr>
        <tr id='L138'>
          <td class='lineno'>138</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L139'>
          <td class='lineno'>139</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>The function checks if a critical point should be skipped based on its distance to other critical points.</span>
          </td>
        </tr>
        <tr id='L140'>
          <td class='lineno'>140</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L141'>
          <td class='lineno'>141</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>The minimum distance check varies based on each nuclear CP.</span>
          </td>
        </tr>
        <tr id='L142'>
          <td class='lineno'>142</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>We know that the closest ring point to a nuclear CP is at least greater than the minimum distance to any bond CP.</span>
          </td>
        </tr>
        <tr id='L143'>
          <td class='lineno'>143</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>Likewise, we know that the closest cage point to a nuclear CP is at least greater than the minimum distance to any ring CP.</span>
          </td>
        </tr>
        <tr id='L144'>
          <td class='lineno'>144</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>Also, we&#39;re adding CPs in the order nuclear -&gt; bond -&gt; ring -&gt; cage, so by the time we have to deal with a ring CP, we know all the nuclear-bond CP distances, and by the time we have to deal with a cage CP, we know all the nuclear-ring CP distances.</span>
          </td>
        </tr>
        <tr id='L145'>
          <td class='lineno'>145</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>If there are ring and bond points already present, then we&#39;ll use for each nuclear CP, the minimum distance to any ring CP that is less than the cutoff_dist_max. </span>
          </td>
        </tr>
        <tr id='L146'>
          <td class='lineno'>146</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>If no ring points are present or none are within the cutoff_dist_max, then we&#39;ll use the minimum distance to any bond CP that&#39;s less than the cutoff_dist_max. </span>
          </td>
        </tr>
        <tr id='L147'>
          <td class='lineno'>147</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>If no bond points are present or none are within the cutoff_dist_max, then we&#39;ll use the default value.</span>
          </td>
        </tr>
        <tr id='L148'>
          <td class='lineno'>148</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>For distances between two non-nuclear CP types, we&#39;ll use the default value of cutoff_dist_min.</span>
          </td>
        </tr>
        <tr id='L149'>
          <td class='lineno'>149</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L150'>
          <td class='lineno'>150</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>## Arguments</span>
          </td>
        </tr>
        <tr id='L151'>
          <td class='lineno'>151</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>- &#96;check_cp::CriticalPoint&#96;: The critical point to check.</span>
          </td>
        </tr>
        <tr id='L152'>
          <td class='lineno'>152</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>- &#96;cp_info::Vector&#123;CriticalPoint&#125;&#96;: A vector of all the critical points.</span>
          </td>
        </tr>
        <tr id='L153'>
          <td class='lineno'>153</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>- &#96;cutoff_dist_min&#61;0.0&#96;: The minimum distance cutoff.</span>
          </td>
        </tr>
        <tr id='L154'>
          <td class='lineno'>154</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>- &#96;cutoff_dist_max&#61;6.0&#96;: The maximum distance cutoff.</span>
          </td>
        </tr>
        <tr id='L155'>
          <td class='lineno'>155</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>- &#96;cutoff_dist_min_nuc_nuc&#61;1.0&#96;: The minimum distance cutoff for nuclear-nuclear critical points.</span>
          </td>
        </tr>
        <tr id='L156'>
          <td class='lineno'>156</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>- &#96;cutoff_index&#61;4&#96;: The cutoff index.</span>
          </td>
        </tr>
        <tr id='L157'>
          <td class='lineno'>157</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L158'>
          <td class='lineno'>158</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>## Returns</span>
          </td>
        </tr>
        <tr id='L159'>
          <td class='lineno'>159</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>- &#96;true&#96; if the critical point should be skipped, &#96;false&#96; otherwise.</span>
          </td>
        </tr>
        <tr id='L160'>
          <td class='lineno'>160</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>&quot;&quot;&quot;</span>
          </td>
        </tr>
        <tr id='L161'>
          <td class='lineno'>161</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>4 &#40;31 &#37;&#41;</td>
          <td>
            <div class='call-sites'>
              8 &#40;62 &#37;&#41;
              samples spent in cp_should_be_skipped
              <br />
              
              4 &#40;50 &#37;&#41; &#40;incl.&#41;
              when called from #find_cps#22
              <a href='critical_points.jl-e501c7201f5f77db71b4e61ad43af0b25550f4ec.html#L367'>line 367</a>
              <br />
              
              4 &#40;50 &#37;&#41; &#40;incl.&#41;
              when called from cp_should_be_skipped
              <a href='critical_points.jl-e501c7201f5f77db71b4e61ad43af0b25550f4ec.html#L161'>line 161</a>
              <br />
            </div>
            <div class='callees'>
              4 &#40;100 &#37;&#41;
              samples spent calling
              <a href='critical_points.jl-e501c7201f5f77db71b4e61ad43af0b25550f4ec.html#L161'>#cp_should_be_skipped#15</a>
              <br />
            </div>
            <span class='code'>function cp_should_be_skipped&#40;</span>
          </td>
        </tr>
        <tr id='L162'>
          <td class='lineno'>162</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    check_cp::CriticalPoint,</span>
          </td>
        </tr>
        <tr id='L163'>
          <td class='lineno'>163</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    cp_info::Vector&#123;CriticalPoint&#125;;</span>
          </td>
        </tr>
        <tr id='L164'>
          <td class='lineno'>164</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    cutoff_dist_min&#61;0.0,</span>
          </td>
        </tr>
        <tr id='L165'>
          <td class='lineno'>165</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    cutoff_dist_max&#61;6.0,</span>
          </td>
        </tr>
        <tr id='L166'>
          <td class='lineno'>166</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    cutoff_dist_min_nuc_nuc&#61;0.5,</span>
          </td>
        </tr>
        <tr id='L167'>
          <td class='lineno'>167</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    cutoff_index&#61;4,</span>
          </td>
        </tr>
        <tr id='L168'>
          <td class='lineno'>168</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>&#41;::Bool</span>
          </td>
        </tr>
        <tr id='L169'>
          <td class='lineno'>169</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    if isempty&#40;cp_info&#41;</span>
          </td>
        </tr>
        <tr id='L170'>
          <td class='lineno'>170</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        return false</span>
          </td>
        </tr>
        <tr id='L171'>
          <td class='lineno'>171</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    end</span>
          </td>
        </tr>
        <tr id='L172'>
          <td class='lineno'>172</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    cp_index_check_list &#61; &#91;i for i in &#91;1, -1, -3&#93; if i &lt; cutoff_index&#93;</span>
          </td>
        </tr>
        <tr id='L173'>
          <td class='lineno'>173</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    for cp in cp_info</span>
          </td>
        </tr>
        <tr id='L174'>
          <td class='lineno'>174</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        check_dist &#61; norm&#40;check_cp.r - cp.r&#41;</span>
          </td>
        </tr>
        <tr id='L175'>
          <td class='lineno'>175</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        if check_dist &gt; cutoff_dist_max</span>
          </td>
        </tr>
        <tr id='L176'>
          <td class='lineno'>176</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            continue</span>
          </td>
        </tr>
        <tr id='L177'>
          <td class='lineno'>177</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        end</span>
          </td>
        </tr>
        <tr id='L178'>
          <td class='lineno'>178</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        if cp.type &#61;&#61; nuclear_cp</span>
          </td>
        </tr>
        <tr id='L179'>
          <td class='lineno'>179</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            for cp_ind in cp_index_check_list</span>
          </td>
        </tr>
        <tr id='L180'>
          <td class='lineno'>180</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>                if check_cp.type &#61;&#61; nuclear_cp &amp;&amp; check_dist &lt; cutoff_dist_min_nuc_nuc</span>
          </td>
        </tr>
        <tr id='L181'>
          <td class='lineno'>181</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>                    return true</span>
          </td>
        </tr>
        <tr id='L182'>
          <td class='lineno'>182</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>                end</span>
          </td>
        </tr>
        <tr id='L183'>
          <td class='lineno'>183</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>                min_cp_dist &#61; cutoff_dist_min</span>
          </td>
        </tr>
        <tr id='L184'>
          <td class='lineno'>184</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>4 &#40;31 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              4 &#40;100 &#37;&#41;
              samples spent calling
              <a href='array.jl-232df4611e311f9afb9b9453eac4b05c87945aff.html#L827'>collect</a>
              <br />
            </div>
            <span class='code'>                point_dists &#61; &#91;</span>
          </td>
        </tr>
        <tr id='L185'>
          <td class='lineno'>185</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>                    norm&#40;cp.r - a.r&#41; for a in cp_info if Int&#40;a.type&#41; &#61;&#61; cp_ind &amp;&amp;</span>
          </td>
        </tr>
        <tr id='L186'>
          <td class='lineno'>186</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>                    cutoff_dist_min &lt;&#61; norm&#40;cp.r - a.r&#41; &lt; cutoff_dist_max</span>
          </td>
        </tr>
        <tr id='L187'>
          <td class='lineno'>187</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>                &#93;</span>
          </td>
        </tr>
        <tr id='L188'>
          <td class='lineno'>188</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>                if &#33;isempty&#40;point_dists&#41;</span>
          </td>
        </tr>
        <tr id='L189'>
          <td class='lineno'>189</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>                    check_factor &#61; cp_ind &#61;&#61; -3 ? 0.1 : 0.6</span>
          </td>
        </tr>
        <tr id='L190'>
          <td class='lineno'>190</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>                    min_cp_dist &#61; minimum&#40;point_dists&#41; * check_factor</span>
          </td>
        </tr>
        <tr id='L191'>
          <td class='lineno'>191</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>                end</span>
          </td>
        </tr>
        <tr id='L192'>
          <td class='lineno'>192</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>                if check_dist &lt; min_cp_dist</span>
          </td>
        </tr>
        <tr id='L193'>
          <td class='lineno'>193</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>                    return true</span>
          </td>
        </tr>
        <tr id='L194'>
          <td class='lineno'>194</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>                end</span>
          </td>
        </tr>
        <tr id='L195'>
          <td class='lineno'>195</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            end</span>
          </td>
        </tr>
        <tr id='L196'>
          <td class='lineno'>196</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        elseif check_dist &lt; cutoff_dist_min</span>
          </td>
        </tr>
        <tr id='L197'>
          <td class='lineno'>197</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            return true</span>
          </td>
        </tr>
        <tr id='L198'>
          <td class='lineno'>198</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        end</span>
          </td>
        </tr>
        <tr id='L199'>
          <td class='lineno'>199</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    end</span>
          </td>
        </tr>
        <tr id='L200'>
          <td class='lineno'>200</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    return false</span>
          </td>
        </tr>
        <tr id='L201'>
          <td class='lineno'>201</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>end</span>
          </td>
        </tr>
        <tr id='L202'>
          <td class='lineno'>202</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L203'>
          <td class='lineno'>203</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>&quot;&quot;&quot;</span>
          </td>
        </tr>
        <tr id='L204'>
          <td class='lineno'>204</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    find_cps&#40;sys::System; spacing&#61;0.1, max_dist_from_atom&#61;6.0, dup_cp_check_dist&#61;1e-4, nuclear_coord_check_dist&#61;1e-4&#41;::Vector&#123;CriticalPoint&#125;</span>
          </td>
        </tr>
        <tr id='L205'>
          <td class='lineno'>205</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L206'>
          <td class='lineno'>206</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>Find critical points in a system.</span>
          </td>
        </tr>
        <tr id='L207'>
          <td class='lineno'>207</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L208'>
          <td class='lineno'>208</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>Parameters:</span>
          </td>
        </tr>
        <tr id='L209'>
          <td class='lineno'>209</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>- sys::System: The system for which to find critical points.</span>
          </td>
        </tr>
        <tr id='L210'>
          <td class='lineno'>210</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>- spacing: The spacing between grid points for the search. Default is 0.1.</span>
          </td>
        </tr>
        <tr id='L211'>
          <td class='lineno'>211</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>- max_dist_from_atom: The maximum distance from an atom for a point to be considered a critical point. Default is 6.0.</span>
          </td>
        </tr>
        <tr id='L212'>
          <td class='lineno'>212</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>- dup_cp_check_dist: The distance threshold for checking duplicate critical points. Default is 1e-4.</span>
          </td>
        </tr>
        <tr id='L213'>
          <td class='lineno'>213</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>- nuclear_coord_check_dist: The distance threshold for checking nuclear coordinates. Default is 1e-4.</span>
          </td>
        </tr>
        <tr id='L214'>
          <td class='lineno'>214</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L215'>
          <td class='lineno'>215</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>Returns:</span>
          </td>
        </tr>
        <tr id='L216'>
          <td class='lineno'>216</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>- Vector&#123;CriticalPoint&#125;: The critical points found in the system.</span>
          </td>
        </tr>
        <tr id='L217'>
          <td class='lineno'>217</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L218'>
          <td class='lineno'>218</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>&quot;&quot;&quot;</span>
          </td>
        </tr>
        <tr id='L219'>
          <td class='lineno'>219</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>4 &#40;31 &#37;&#41;</td>
          <td>
            <div class='call-sites'>
              8 &#40;62 &#37;&#41;
              samples spent in find_cps
              <br />
              
              4 &#40;50 &#37;&#41; &#40;incl.&#41;
              when called from #163
              <a href='profiling.jl-6bfbe717c729fd9130ea9672d3eeba50ac5ecb59.html#L126'>line 126</a>
              <br />
              
              4 &#40;50 &#37;&#41; &#40;incl.&#41;
              when called from find_cps
              <a href='critical_points.jl-e501c7201f5f77db71b4e61ad43af0b25550f4ec.html#L219'>line 219</a>
              <br />
            </div>
            <div class='callees'>
              4 &#40;100 &#37;&#41;
              samples spent calling
              <a href='critical_points.jl-e501c7201f5f77db71b4e61ad43af0b25550f4ec.html#L219'>#find_cps#22</a>
              <br />
            </div>
            <span class='code'>function find_cps&#40;</span>
          </td>
        </tr>
        <tr id='L220'>
          <td class='lineno'>220</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    sys::System;</span>
          </td>
        </tr>
        <tr id='L221'>
          <td class='lineno'>221</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    spacing&#61;0.4,</span>
          </td>
        </tr>
        <tr id='L222'>
          <td class='lineno'>222</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    dup_cp_check_dist&#61;0.3,</span>
          </td>
        </tr>
        <tr id='L223'>
          <td class='lineno'>223</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    cutoff_rho&#61;1e-3,</span>
          </td>
        </tr>
        <tr id='L224'>
          <td class='lineno'>224</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    cutoff_grad&#61;1e-4,</span>
          </td>
        </tr>
        <tr id='L225'>
          <td class='lineno'>225</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    cutoff_dist_from_atom&#61;4.0,</span>
          </td>
        </tr>
        <tr id='L226'>
          <td class='lineno'>226</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>&#41;::Vector&#123;CriticalPoint&#125;</span>
          </td>
        </tr>
        <tr id='L227'>
          <td class='lineno'>227</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    n_pts &#61; &#91;max&#40;1, round&#40;Int, norm&#40;sys.grid.lattice_full&#91;i, :&#93;&#41; / spacing&#41;&#41; for i in 1:3&#93;</span>
          </td>
        </tr>
        <tr id='L228'>
          <td class='lineno'>228</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    lattice &#61; hcat&#40;&#91;sys.grid.lattice_full&#91;i, :&#93; / n_pts&#91;i&#93; for i in 1:3&#93;...&#41;</span>
          </td>
        </tr>
        <tr id='L229'>
          <td class='lineno'>229</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    # define critical point search grid</span>
          </td>
        </tr>
        <tr id='L230'>
          <td class='lineno'>230</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    gs &#61; GridSpec&#40;sys.grid.origin, lattice, n_pts&#41;</span>
          </td>
        </tr>
        <tr id='L231'>
          <td class='lineno'>231</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    @debug &quot;search grid spec&quot; gs</span>
          </td>
        </tr>
        <tr id='L232'>
          <td class='lineno'>232</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    X, Y, Z &#61; generate_interpolation_grid&#40;gs&#41;</span>
          </td>
        </tr>
        <tr id='L233'>
          <td class='lineno'>233</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    X, Y, Z &#61; &#91;v&#91;1:&#40;end - 1&#41;&#93; for v in &#40;X, Y, Z&#41;&#93;</span>
          </td>
        </tr>
        <tr id='L234'>
          <td class='lineno'>234</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    n_pts .-&#61; 1</span>
          </td>
        </tr>
        <tr id='L235'>
          <td class='lineno'>235</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L236'>
          <td class='lineno'>236</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    @info &quot;CP search using &#36;&#40;n_pts&#91;1&#93;&#41;x&#36;&#40;n_pts&#91;2&#93;&#41;x&#36;&#40;n_pts&#91;3&#93;&#41; &#61; &#36;&#40;prod&#40;length.&#40;&#91;X,Y,Z&#93;&#41;&#41;&#41; cells with spacing of &#36;spacing&quot;</span>
          </td>
        </tr>
        <tr id='L237'>
          <td class='lineno'>237</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    @debug &quot;Search grid size&quot; size&#40;X&#41; size&#40;Y&#41; size&#40;Z&#41;</span>
          </td>
        </tr>
        <tr id='L238'>
          <td class='lineno'>238</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    results &#61; &#91;&#91;&#93; for i in 1:Threads.nthreads&#40;&#41;&#93;</span>
          </td>
        </tr>
        <tr id='L239'>
          <td class='lineno'>239</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L240'>
          <td class='lineno'>240</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    # Run a search at the midpoint between neighboring atom coords.</span>
          </td>
        </tr>
        <tr id='L241'>
          <td class='lineno'>241</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    # Store edges to be searched as a set</span>
          </td>
        </tr>
        <tr id='L242'>
          <td class='lineno'>242</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    if length&#40;sys.atoms&#41; &gt; 1</span>
          </td>
        </tr>
        <tr id='L243'>
          <td class='lineno'>243</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        get_edge&#40;n1, n2&#41; &#61; &#40;n1 &lt; n2&#41; ? &#40;n1, n2&#41; : &#40;n2, n1&#41;</span>
          </td>
        </tr>
        <tr id='L244'>
          <td class='lineno'>244</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        edge_set &#61; Set&#123;Tuple&#123;Int,Int&#125;&#125;&#40;&#41;</span>
          </td>
        </tr>
        <tr id='L245'>
          <td class='lineno'>245</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        for i in 1:length&#40;sys.atoms&#41;, j in &#40;i &#43; 1&#41;:length&#40;sys.atoms&#41;</span>
          </td>
        </tr>
        <tr id='L246'>
          <td class='lineno'>246</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            # only include if distance is less than cutoff_dist_from_atom</span>
          </td>
        </tr>
        <tr id='L247'>
          <td class='lineno'>247</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            if norm&#40;sys.atoms&#91;i&#93;.r - sys.atoms&#91;j&#93;.r&#41; &lt; cutoff_dist_from_atom</span>
          </td>
        </tr>
        <tr id='L248'>
          <td class='lineno'>248</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>                push&#33;&#40;edge_set, get_edge&#40;i, j&#41;&#41;</span>
          </td>
        </tr>
        <tr id='L249'>
          <td class='lineno'>249</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            end</span>
          </td>
        </tr>
        <tr id='L250'>
          <td class='lineno'>250</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        end</span>
          </td>
        </tr>
        <tr id='L251'>
          <td class='lineno'>251</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L252'>
          <td class='lineno'>252</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        # get rho values at atom coords</span>
          </td>
        </tr>
        <tr id='L253'>
          <td class='lineno'>253</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        atom_r &#61; invert&#40;&#91;a.r for a in sys.atoms&#93;&#41;</span>
          </td>
        </tr>
        <tr id='L254'>
          <td class='lineno'>254</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        atom_rho &#61; log1p.&#40;sys.rho_xyz.&#40;atom_r&#91;1&#93;, atom_r&#91;2&#93;, atom_r&#91;3&#93;&#41;&#41;</span>
          </td>
        </tr>
        <tr id='L255'>
          <td class='lineno'>255</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L256'>
          <td class='lineno'>256</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        # now loop over edges, doing a search at the midpoint of each.</span>
          </td>
        </tr>
        <tr id='L257'>
          <td class='lineno'>257</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        # make list from edge set</span>
          </td>
        </tr>
        <tr id='L258'>
          <td class='lineno'>258</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        edge_set &#61; collect&#40;edge_set&#41;</span>
          </td>
        </tr>
        <tr id='L259'>
          <td class='lineno'>259</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        Threads.@threads for e in edge_set</span>
          </td>
        </tr>
        <tr id='L260'>
          <td class='lineno'>260</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            i1, i2 &#61; e</span>
          </td>
        </tr>
        <tr id='L261'>
          <td class='lineno'>261</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            # position midpoint based on ratio of log&#40;rho&#41;</span>
          </td>
        </tr>
        <tr id='L262'>
          <td class='lineno'>262</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            rho_tot &#61; atom_rho&#91;i1&#93; &#43; atom_rho&#91;i2&#93;</span>
          </td>
        </tr>
        <tr id='L263'>
          <td class='lineno'>263</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            k &#61; atom_rho&#91;i2&#93; / rho_tot</span>
          </td>
        </tr>
        <tr id='L264'>
          <td class='lineno'>264</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            x &#61; sys.atoms&#91;i1&#93;.r * k &#43; sys.atoms&#91;i2&#93;.r * &#40;1 - k&#41;</span>
          </td>
        </tr>
        <tr id='L265'>
          <td class='lineno'>265</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            gs1 &#61; GridSpec&#40;</span>
          </td>
        </tr>
        <tr id='L266'>
          <td class='lineno'>266</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>                x - gs.lattice * 1.5ones&#40;3&#41;, gs.lattice * diagm&#40;3ones&#40;3&#41;&#41;, &#91;1, 1, 1&#93;</span>
          </td>
        </tr>
        <tr id='L267'>
          <td class='lineno'>267</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            &#41;</span>
          </td>
        </tr>
        <tr id='L268'>
          <td class='lineno'>268</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            function fb&#33;&#40;F, x&#41;</span>
          </td>
        </tr>
        <tr id='L269'>
          <td class='lineno'>269</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>                @assert in_bounding_box&#40;x, gs1&#41;</span>
          </td>
        </tr>
        <tr id='L270'>
          <td class='lineno'>270</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>                return sys.grad&#33;&#40;F, x&#41;</span>
          </td>
        </tr>
        <tr id='L271'>
          <td class='lineno'>271</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            end</span>
          </td>
        </tr>
        <tr id='L272'>
          <td class='lineno'>272</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            function jb&#33;&#40;F, x&#41;</span>
          </td>
        </tr>
        <tr id='L273'>
          <td class='lineno'>273</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>                @assert in_bounding_box&#40;x, gs1&#41;</span>
          </td>
        </tr>
        <tr id='L274'>
          <td class='lineno'>274</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>                return sys.hess&#33;&#40;F, x&#41;</span>
          </td>
        </tr>
        <tr id='L275'>
          <td class='lineno'>275</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            end</span>
          </td>
        </tr>
        <tr id='L276'>
          <td class='lineno'>276</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            # run root finder in cell</span>
          </td>
        </tr>
        <tr id='L277'>
          <td class='lineno'>277</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            try</span>
          </td>
        </tr>
        <tr id='L278'>
          <td class='lineno'>278</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>                r &#61; nlsolve&#40;fb&#33;, jb&#33;, x&#41;</span>
          </td>
        </tr>
        <tr id='L279'>
          <td class='lineno'>279</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>                if r.x_converged || r.f_converged</span>
          </td>
        </tr>
        <tr id='L280'>
          <td class='lineno'>280</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>                    # save if converged</span>
          </td>
        </tr>
        <tr id='L281'>
          <td class='lineno'>281</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>                    # @debug &quot;CP found&quot; r.zero</span>
          </td>
        </tr>
        <tr id='L282'>
          <td class='lineno'>282</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L283'>
          <td class='lineno'>283</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>                    push&#33;&#40;results&#91;Threads.threadid&#40;&#41;&#93;, r&#41;</span>
          </td>
        </tr>
        <tr id='L284'>
          <td class='lineno'>284</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>                end</span>
          </td>
        </tr>
        <tr id='L285'>
          <td class='lineno'>285</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            catch e</span>
          </td>
        </tr>
        <tr id='L286'>
          <td class='lineno'>286</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>                continue</span>
          </td>
        </tr>
        <tr id='L287'>
          <td class='lineno'>287</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>                @debug &quot;grid point failed&quot; x e</span>
          </td>
        </tr>
        <tr id='L288'>
          <td class='lineno'>288</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            end</span>
          </td>
        </tr>
        <tr id='L289'>
          <td class='lineno'>289</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        end</span>
          </td>
        </tr>
        <tr id='L290'>
          <td class='lineno'>290</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    end</span>
          </td>
        </tr>
        <tr id='L291'>
          <td class='lineno'>291</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L292'>
          <td class='lineno'>292</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    midpt &#61; sys.grid.origin .&#43; &#40;sys.grid.lattice_full .* 0.5&#41; * ones&#40;3&#41;</span>
          </td>
        </tr>
        <tr id='L293'>
          <td class='lineno'>293</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    # The actual cutoff distance used is a factor of the diagonal length of the system grid</span>
          </td>
        </tr>
        <tr id='L294'>
          <td class='lineno'>294</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    # &#40;the distance between the origin and the farthest corner of the grid&#41;</span>
          </td>
        </tr>
        <tr id='L295'>
          <td class='lineno'>295</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    cutoff_dist &#61; minimum&#40;&#91;norm&#40;sys.grid.lattice_full&#91;:, i&#93;&#41; for i in 1:3&#93;&#41; * 0.3</span>
          </td>
        </tr>
        <tr id='L296'>
          <td class='lineno'>296</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L297'>
          <td class='lineno'>297</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    # perform grid-based CP search in shared memory parallel</span>
          </td>
        </tr>
        <tr id='L298'>
          <td class='lineno'>298</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    Threads.@threads for xi in 1:length&#40;X&#41;</span>
          </td>
        </tr>
        <tr id='L299'>
          <td class='lineno'>299</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        for yi in 1:length&#40;Y&#41;, zi in 1:length&#40;Z&#41;</span>
          </td>
        </tr>
        <tr id='L300'>
          <td class='lineno'>300</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            low &#61; gs.origin &#43; gs.lattice * float.&#40;&#91;xi, yi, zi&#93; .- 1&#41;</span>
          </td>
        </tr>
        <tr id='L301'>
          <td class='lineno'>301</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            x &#61; low &#43; gs.lattice * 0.5ones&#40;3&#41;</span>
          </td>
        </tr>
        <tr id='L302'>
          <td class='lineno'>302</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            # check against cutoffs</span>
          </td>
        </tr>
        <tr id='L303'>
          <td class='lineno'>303</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            dist_to_midpt &#61; norm&#40;x - midpt&#41;</span>
          </td>
        </tr>
        <tr id='L304'>
          <td class='lineno'>304</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>1 &#40;8 &#37;&#41;</td>
          <td>
            <div class='call-sites'>
              1 &#40;8 &#37;&#41;
              samples spent in macro expansion
              <br />
              
              1 &#40;100 &#37;&#41; &#40;incl.&#41;
              when called from #146#threadsfor_fun#30
              <a href='threadingconstructs.jl-55ab8bded76260536c4e3ceb059e4391e0a81dc6.html#L215'>line 215</a>
              <br />
            </div>
            <div class='callees'>
              1 &#40;100 &#37;&#41;
              samples spent calling
              <a href='data_loaders.jl-5718b3453fac82caec1fadc8e45c17b743d045d3.html#L45'>rho</a>
              <br />
            </div>
            <span class='code'>            if dist_to_midpt &gt; cutoff_dist &amp;&amp;</span>
          </td>
        </tr>
        <tr id='L305'>
          <td class='lineno'>305</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>                &#40;sys.rho&#40;x&#41; &lt; cutoff_rho || norm&#40;sys.grad&#40;x&#41;&#41; &lt; cutoff_grad&#41;</span>
          </td>
        </tr>
        <tr id='L306'>
          <td class='lineno'>306</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>                continue</span>
          </td>
        </tr>
        <tr id='L307'>
          <td class='lineno'>307</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            end</span>
          </td>
        </tr>
        <tr id='L308'>
          <td class='lineno'>308</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            # check not within check dist of nuclear coordinates</span>
          </td>
        </tr>
        <tr id='L309'>
          <td class='lineno'>309</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            if &#33;isempty&#40;sys.atoms&#41;</span>
          </td>
        </tr>
        <tr id='L310'>
          <td class='lineno'>310</td>
          <td class='tracecount excl'>1 &#40;8 &#37;&#41;</td>
          <td class='tracecount incl'>1 &#40;8 &#37;&#41;</td>
          <td>
            <div class='call-sites'>
              1 &#40;8 &#37;&#41;
              samples spent in macro expansion
              <br />
              1 &#40;100 &#37;&#41; &#40;ex.&#41;,
              1 &#40;100 &#37;&#41; &#40;incl.&#41;
              when called from #146#threadsfor_fun#30
              <a href='threadingconstructs.jl-55ab8bded76260536c4e3ceb059e4391e0a81dc6.html#L215'>line 215</a>
              <br />
            </div>
            
            <span class='code'>                min_atom_dist &#61; minimum&#40;&#91;norm&#40;x - a.r&#41; for a in sys.atoms&#93;&#41;</span>
          </td>
        </tr>
        <tr id='L311'>
          <td class='lineno'>311</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>                if min_atom_dist &lt; dup_cp_check_dist ||</span>
          </td>
        </tr>
        <tr id='L312'>
          <td class='lineno'>312</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>                    min_atom_dist &gt; cutoff_dist_from_atom</span>
          </td>
        </tr>
        <tr id='L313'>
          <td class='lineno'>313</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>                    continue</span>
          </td>
        </tr>
        <tr id='L314'>
          <td class='lineno'>314</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>                end</span>
          </td>
        </tr>
        <tr id='L315'>
          <td class='lineno'>315</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            end</span>
          </td>
        </tr>
        <tr id='L316'>
          <td class='lineno'>316</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            if any&#40;&#91;&#33;isempty&#40;i&#41; for i in results&#93;&#41;</span>
          </td>
        </tr>
        <tr id='L317'>
          <td class='lineno'>317</td>
          <td class='tracecount excl'>1 &#40;8 &#37;&#41;</td>
          <td class='tracecount incl'>3 &#40;23 &#37;&#41;</td>
          <td>
            <div class='call-sites'>
              3 &#40;23 &#37;&#41;
              samples spent in macro expansion
              <br />
              1 &#40;33 &#37;&#41; &#40;ex.&#41;,
              3 &#40;100 &#37;&#41; &#40;incl.&#41;
              when called from #146#threadsfor_fun#30
              <a href='threadingconstructs.jl-55ab8bded76260536c4e3ceb059e4391e0a81dc6.html#L215'>line 215</a>
              <br />
            </div>
            <div class='callees'>
              2 &#40;100 &#37;&#41;
              samples spent calling
              <a href='array.jl-232df4611e311f9afb9b9453eac4b05c87945aff.html#L759'>collect</a>
              <br />
            </div>
            <span class='code'>                min_point_dist &#61; minimum&#40;&#91;norm&#40;x - r.zero&#41; for ro in results for r in ro&#93;&#41;</span>
          </td>
        </tr>
        <tr id='L318'>
          <td class='lineno'>318</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>                if min_point_dist &lt; dup_cp_check_dist</span>
          </td>
        </tr>
        <tr id='L319'>
          <td class='lineno'>319</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>                    continue</span>
          </td>
        </tr>
        <tr id='L320'>
          <td class='lineno'>320</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>                end</span>
          </td>
        </tr>
        <tr id='L321'>
          <td class='lineno'>321</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            end</span>
          </td>
        </tr>
        <tr id='L322'>
          <td class='lineno'>322</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            gs1 &#61; GridSpec&#40;</span>
          </td>
        </tr>
        <tr id='L323'>
          <td class='lineno'>323</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>                low - gs.lattice * 0.2ones&#40;3&#41;, gs.lattice * diagm&#40;1.4ones&#40;3&#41;&#41;, &#91;1, 1, 1&#93;</span>
          </td>
        </tr>
        <tr id='L324'>
          <td class='lineno'>324</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            &#41;</span>
          </td>
        </tr>
        <tr id='L325'>
          <td class='lineno'>325</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            <div class='call-sites'>
              2 &#40;15 &#37;&#41;
              samples spent in fb&#33;
              <br />
              
              2 &#40;100 &#37;&#41; &#40;incl.&#41;
              when called from value&#33;&#33;
              <a href='interface.jl-f2c29230e804547c565f1aa8a029bdb0b99b1849.html#L166'>line 166</a>
              <br />
            </div>
            
            <span class='code'>            function fb&#33;&#40;F, x&#41;</span>
          </td>
        </tr>
        <tr id='L326'>
          <td class='lineno'>326</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>2 &#40;15 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              2 &#40;100 &#37;&#41;
              samples spent calling
              <a href='systems.jl-aad801bccb2afccee29bd505d52e993c028f1145.html#L236'>in_bounding_box</a>
              <br />
            </div>
            <span class='code'>                @assert in_bounding_box&#40;x, gs1&#41;</span>
          </td>
        </tr>
        <tr id='L327'>
          <td class='lineno'>327</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>                return sys.grad&#33;&#40;F, x&#41;</span>
          </td>
        </tr>
        <tr id='L328'>
          <td class='lineno'>328</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            end</span>
          </td>
        </tr>
        <tr id='L329'>
          <td class='lineno'>329</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            <div class='call-sites'>
              1 &#40;8 &#37;&#41;
              samples spent in jb&#33;
              <br />
              
              1 &#40;100 &#37;&#41; &#40;incl.&#41;
              when called from fj&#33;
              <a href='abstract.jl-a81708fd19b8615bb91957ad1ab557c3ed109beb.html#L7'>line 7</a>
              <br />
            </div>
            
            <span class='code'>            function jb&#33;&#40;F, x&#41;</span>
          </td>
        </tr>
        <tr id='L330'>
          <td class='lineno'>330</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>1 &#40;8 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              1 &#40;100 &#37;&#41;
              samples spent calling
              <a href='systems.jl-aad801bccb2afccee29bd505d52e993c028f1145.html#L236'>in_bounding_box</a>
              <br />
            </div>
            <span class='code'>                @assert in_bounding_box&#40;x, gs1&#41;</span>
          </td>
        </tr>
        <tr id='L331'>
          <td class='lineno'>331</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>                return sys.hess&#33;&#40;F, x&#41;</span>
          </td>
        </tr>
        <tr id='L332'>
          <td class='lineno'>332</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            end</span>
          </td>
        </tr>
        <tr id='L333'>
          <td class='lineno'>333</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            # run root finder in cell</span>
          </td>
        </tr>
        <tr id='L334'>
          <td class='lineno'>334</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            try</span>
          </td>
        </tr>
        <tr id='L335'>
          <td class='lineno'>335</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>                # @debug &quot;searching cell &#36;xi &#36;yi &#36;zi&quot; low high</span>
          </td>
        </tr>
        <tr id='L336'>
          <td class='lineno'>336</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>4 &#40;31 &#37;&#41;</td>
          <td>
            <div class='call-sites'>
              4 &#40;31 &#37;&#41;
              samples spent in macro expansion
              <br />
              
              4 &#40;100 &#37;&#41; &#40;incl.&#41;
              when called from #146#threadsfor_fun#30
              <a href='threadingconstructs.jl-55ab8bded76260536c4e3ceb059e4391e0a81dc6.html#L215'>line 215</a>
              <br />
            </div>
            <div class='callees'>
              4 &#40;100 &#37;&#41;
              samples spent calling
              <a href='nlsolve.jl-3c09a6fa7d2424bc9f872603c9ab10e1a8478a03.html#L56'>nlsolve</a>
              <br />
            </div>
            <span class='code'>                r &#61; nlsolve&#40;fb&#33;, jb&#33;, x&#41;</span>
          </td>
        </tr>
        <tr id='L337'>
          <td class='lineno'>337</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>                if r.x_converged || r.f_converged</span>
          </td>
        </tr>
        <tr id='L338'>
          <td class='lineno'>338</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>                    # save if converged</span>
          </td>
        </tr>
        <tr id='L339'>
          <td class='lineno'>339</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>                    # @debug &quot;CP found&quot; r.zero</span>
          </td>
        </tr>
        <tr id='L340'>
          <td class='lineno'>340</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L341'>
          <td class='lineno'>341</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>                    push&#33;&#40;results&#91;Threads.threadid&#40;&#41;&#93;, r&#41;</span>
          </td>
        </tr>
        <tr id='L342'>
          <td class='lineno'>342</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>                end</span>
          </td>
        </tr>
        <tr id='L343'>
          <td class='lineno'>343</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            catch e</span>
          </td>
        </tr>
        <tr id='L344'>
          <td class='lineno'>344</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>                continue</span>
          </td>
        </tr>
        <tr id='L345'>
          <td class='lineno'>345</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>                @debug &quot;grid point failed&quot; x e</span>
          </td>
        </tr>
        <tr id='L346'>
          <td class='lineno'>346</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            end</span>
          </td>
        </tr>
        <tr id='L347'>
          <td class='lineno'>347</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        end</span>
          </td>
        </tr>
        <tr id='L348'>
          <td class='lineno'>348</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    end</span>
          </td>
        </tr>
        <tr id='L349'>
          <td class='lineno'>349</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'></span>
          </td>
        </tr>
        <tr id='L350'>
          <td class='lineno'>350</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    # create critical point data structure</span>
          </td>
        </tr>
        <tr id='L351'>
          <td class='lineno'>351</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    cp_info &#61; Vector&#123;CriticalPoint&#125;&#40;&#41;</span>
          </td>
        </tr>
        <tr id='L352'>
          <td class='lineno'>352</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    # add nuclear coordinates to the results</span>
          </td>
        </tr>
        <tr id='L353'>
          <td class='lineno'>353</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    for &#40;i, a&#41; in enumerate&#40;sys.atoms&#41;</span>
          </td>
        </tr>
        <tr id='L354'>
          <td class='lineno'>354</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        push&#33;&#40;cp_info, CriticalPoint&#40;a.r, -3; i_atom&#61;i&#41;&#41;</span>
          </td>
        </tr>
        <tr id='L355'>
          <td class='lineno'>355</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    end</span>
          </td>
        </tr>
        <tr id='L356'>
          <td class='lineno'>356</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    index_list &#61; &#91;-3, -1, 1, 3&#93;</span>
          </td>
        </tr>
        <tr id='L357'>
          <td class='lineno'>357</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    for cp_ind in index_list, ro in results, r in ro</span>
          </td>
        </tr>
        <tr id='L358'>
          <td class='lineno'>358</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        x1 &#61; r.zero</span>
          </td>
        </tr>
        <tr id='L359'>
          <td class='lineno'>359</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        ρ &#61; sys.rho&#40;x1&#41;</span>
          </td>
        </tr>
        <tr id='L360'>
          <td class='lineno'>360</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        A &#61; sys.hess&#40;x1&#41;</span>
          </td>
        </tr>
        <tr id='L361'>
          <td class='lineno'>361</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        λ &#61; eigvals&#40;A&#41;</span>
          </td>
        </tr>
        <tr id='L362'>
          <td class='lineno'>362</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        cp_index &#61; Int&#40;sum&#40;sign.&#40;λ&#41;&#41;&#41;</span>
          </td>
        </tr>
        <tr id='L363'>
          <td class='lineno'>363</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        if cp_index &#33;&#61; cp_ind</span>
          </td>
        </tr>
        <tr id='L364'>
          <td class='lineno'>364</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            continue # skip points with incorrect cp_index</span>
          </td>
        </tr>
        <tr id='L365'>
          <td class='lineno'>365</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        end</span>
          </td>
        </tr>
        <tr id='L366'>
          <td class='lineno'>366</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        cp &#61; CriticalPoint&#40;x1, cp_index&#41;</span>
          </td>
        </tr>
        <tr id='L367'>
          <td class='lineno'>367</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'>4 &#40;31 &#37;&#41;</td>
          <td>
            
            <div class='callees'>
              4 &#40;100 &#37;&#41;
              samples spent calling
              <a href='critical_points.jl-e501c7201f5f77db71b4e61ad43af0b25550f4ec.html#L161'>cp_should_be_skipped</a>
              <br />
            </div>
            <span class='code'>        if cp_should_be_skipped&#40;</span>
          </td>
        </tr>
        <tr id='L368'>
          <td class='lineno'>368</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            cp, cp_info; cutoff_dist_min&#61;dup_cp_check_dist, cutoff_index&#61;cp_ind</span>
          </td>
        </tr>
        <tr id='L369'>
          <td class='lineno'>369</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        &#41;</span>
          </td>
        </tr>
        <tr id='L370'>
          <td class='lineno'>370</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>            continue</span>
          </td>
        </tr>
        <tr id='L371'>
          <td class='lineno'>371</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        end</span>
          </td>
        </tr>
        <tr id='L372'>
          <td class='lineno'>372</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        # @debug &quot;found cp_index &#36;&#40;cp_index&#41; at&quot; pr&#40;x1&#41; cp_index nuclear_coord_ind</span>
          </td>
        </tr>
        <tr id='L373'>
          <td class='lineno'>373</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        push&#33;&#40;cp_info, cp&#41;</span>
          </td>
        </tr>
        <tr id='L374'>
          <td class='lineno'>374</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    end</span>
          </td>
        </tr>
        <tr id='L375'>
          <td class='lineno'>375</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    if length&#40;cp_info&#41; &#61;&#61; 0</span>
          </td>
        </tr>
        <tr id='L376'>
          <td class='lineno'>376</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        @warn &quot;No critical points found&quot;</span>
          </td>
        </tr>
        <tr id='L377'>
          <td class='lineno'>377</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        return cp_info</span>
          </td>
        </tr>
        <tr id='L378'>
          <td class='lineno'>378</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    end</span>
          </td>
        </tr>
        <tr id='L379'>
          <td class='lineno'>379</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    max_rho &#61; maximum&#40;x -&gt; x, &#91;sys.rho&#40;cp.r&#41; for cp in cp_info&#93;&#41; &#43; 1.0</span>
          </td>
        </tr>
        <tr id='L380'>
          <td class='lineno'>380</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    sort&#33;&#40;cp_info; by&#61;cp -&gt; Int&#40;cp.type&#41; &#43; sys.rho&#40;cp.r&#41; / max_rho&#41;</span>
          </td>
        </tr>
        <tr id='L381'>
          <td class='lineno'>381</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    @info &quot;&#36;&#40;length&#40;cp_info&#41;&#41; CPs found&quot;</span>
          </td>
        </tr>
        <tr id='L382'>
          <td class='lineno'>382</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    for rnk in &#91;nuclear_cp, bond_cp, ring_cp, cage_cp&#93;</span>
          </td>
        </tr>
        <tr id='L383'>
          <td class='lineno'>383</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        cps &#61; &#91;cp for cp in cp_info if cp.type &#61;&#61; rnk&#93;</span>
          </td>
        </tr>
        <tr id='L384'>
          <td class='lineno'>384</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        @info &quot;&#36;&#40;length&#40;cps&#41;&#41; cps of cp_index &#36;&#40;rnk&#41;&quot;</span>
          </td>
        </tr>
        <tr id='L385'>
          <td class='lineno'>385</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    end</span>
          </td>
        </tr>
        <tr id='L386'>
          <td class='lineno'>386</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    poincare_hopf_relation_value &#61; poincare_hopf_value&#40;cp_info&#41;</span>
          </td>
        </tr>
        <tr id='L387'>
          <td class='lineno'>387</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    if poincare_hopf_relation_value &#33;&#61; 1</span>
          </td>
        </tr>
        <tr id='L388'>
          <td class='lineno'>388</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>        @warn &quot;Poincaré-Hopf relation &#40;NCP - BCP &#43; RCP - CCP &#61; 1&#41; not satisfied for system: &#36;&#40;sys.name&#41;&quot; poincare_hopf_relation_value</span>
          </td>
        </tr>
        <tr id='L389'>
          <td class='lineno'>389</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    end</span>
          </td>
        </tr>
        <tr id='L390'>
          <td class='lineno'>390</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>    return cp_info</span>
          </td>
        </tr>
        <tr id='L391'>
          <td class='lineno'>391</td>
          <td class='tracecount excl'></td>
          <td class='tracecount incl'></td>
          <td>
            
            
            <span class='code'>end</span>
          </td>
        </tr>
      </tbody>
    </table>
  </body>
</html>

